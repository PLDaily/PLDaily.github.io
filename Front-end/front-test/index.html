
<!DOCTYPE html>
<html lang="en">
    
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="PLDaily">
    <title>前端单元测试 - PLDaily</title>
    <meta name="author" content="PLDaily">
    
    
        <link rel="icon" href="http://yoursite.com/assets/images/avatar.ico">
    
    
    <meta name="description" content="为保证代码的质量，单元测试必不可少。本文记录自己在学习单元测试过程中的一些总结。">
<meta name="keywords" content="JavaScript">
<meta property="og:type" content="blog">
<meta property="og:title" content="前端单元测试">
<meta property="og:url" content="http://yoursite.com/Front-end/front-test/index.html">
<meta property="og:site_name" content="PLDaily">
<meta property="og:description" content="为保证代码的质量，单元测试必不可少。本文记录自己在学习单元测试过程中的一些总结。">
<meta property="og:locale" content="en">
<meta property="og:image" content="https://user-images.githubusercontent.com/11615211/34821686-89f77060-f6ff-11e7-9875-f5e878b27a69.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/11615211/34821707-961104c4-f6ff-11e7-9bd9-ffedadcac833.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/11615211/34821960-4099ac84-f700-11e7-99f8-c2a665457cf8.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/11615211/34821742-a99a982a-f6ff-11e7-9169-fa265197159e.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/11615211/34821773-bcf4636a-f6ff-11e7-9f92-223e31eaf553.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/11615211/34821810-db0fd622-f6ff-11e7-8f80-53eda337076b.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/11615211/34821863-f1ea35e0-f6ff-11e7-9645-10b845bf0035.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/11615211/34821876-fbd9b990-f6ff-11e7-8c1b-184ee96fa4ba.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/11615211/34821893-07cfdfcc-f700-11e7-9c0d-d8dc2bf0b6bb.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/11615211/34821908-1621cfae-f700-11e7-95bc-40ca5be5417b.png">
<meta property="og:image" content="https://user-images.githubusercontent.com/11615211/34821915-1b098d68-f700-11e7-9650-2cb7a0e0b920.png">
<meta property="og:updated_time" content="2018-02-28T09:30:39.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="前端单元测试">
<meta name="twitter:description" content="为保证代码的质量，单元测试必不可少。本文记录自己在学习单元测试过程中的一些总结。">
<meta name="twitter:image" content="https://user-images.githubusercontent.com/11615211/34821686-89f77060-f6ff-11e7-9875-f5e878b27a69.png">
    
    
        
    
    
        <meta property="og:image" content="http://yoursite.com/assets/images/avatar.jpg"/>
    
    
    
    
    <!--STYLES-->
    <link rel="stylesheet" href="/assets/css/style-pz4cc6y13wt2trzqa8l3n9v0yykr0sstdaheem7qj628nhjmhp9pfawvqawz.min.css">
    <!--STYLES END-->
    

    
</head>

    <body>
        <div id="blog">
            <!-- Define author's picture -->


    
        
            
        
    

<header id="header" data-behavior="3">
    <i id="btn-open-sidebar" class="fa fa-lg fa-bars"></i>
    <div class="header-title">
        <a class="header-title-link" href="/ ">PLDaily</a>
    </div>
    
        
            <a  class="header-right-picture "
                href="#about">
        
        
            <img class="header-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
        
        </a>
    
</header>

            <!-- Define author's picture -->



        
    

<nav id="sidebar" data-behavior="3">
    <div class="sidebar-container">
        
            <div class="sidebar-profile">
                <a href="/#about">
                    <img class="sidebar-profile-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
                </a>
                <h4 class="sidebar-profile-name">PLDaily</h4>
                
                    <h5 class="sidebar-profile-bio"><p>yesterday you said tomorrow</p>
</h5>
                
            </div>
        
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/ "
                            
                            title="Home"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-home" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Home</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-categories"
                            
                            title="Categories"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-bookmark" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Categories</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-tags"
                            
                            title="Tags"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-tags" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Tags</span>
                    </a>
            </li>
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link "
                             href="/all-archives"
                            
                            title="Archives"
                        >
                    
                        <i class="sidebar-button-icon fa fa-lg fa-archive" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">Archives</span>
                    </a>
            </li>
            
        </ul>
        
            <ul class="sidebar-buttons">
            
                <li class="sidebar-button">
                    
                        <a  class="sidebar-button-link " href="https://github.com/pldaily" target="_blank" rel="noopener" title="GitHub">
                    
                        <i class="sidebar-button-icon fa fa-lg fa-github" aria-hidden="true"></i>
                        <span class="sidebar-button-desc">GitHub</span>
                    </a>
            </li>
            
        </ul>
        
    </div>
</nav>

            
            <div id="main" data-behavior="3"
                 class="
                        hasCoverMetaIn
                        ">
                
<article class="post" itemscope itemType="http://schema.org/BlogPosting">
    
    
        <div class="post-header main-content-wrap text-left">
    
        <h1 class="post-title" itemprop="headline">
            前端单元测试
        </h1>
    
    
        <div class="post-meta">
    <time itemprop="datePublished" datetime="2018-01-10T17:05:43+08:00">
	
		    Jan 10, 2018
    	
    </time>
    
        <span>in </span>
        
    <a class="category-link" href="/categories/Front-end/">Front-end</a>


    
</div>

    
</div>
    
    <div class="post-content markdown" itemprop="articleBody">
        <div class="main-content-wrap">
            <p>为保证代码的质量，单元测试必不可少。本文记录自己在学习单元测试过程中的一些总结。<br><a id="more"></a></p>
<h3 id="TDD与BDD的区别"><a href="#TDD与BDD的区别" class="headerlink" title="TDD与BDD的区别"></a>TDD与BDD的区别</h3><p>TDD属于测试驱动开发，BDD属于行为驱动开发。个人理解其实就是TDD先写测试模块，再写主功能代码，然后能让测试模块通过测试，而BDD是先写主功能模块，z再写测试模块。详见<a href="https://github.com/jdavis/tdd-vs-bdd" target="_blank" rel="noopener">示例</a></p>
<h3 id="服务端代码测试"><a href="#服务端代码测试" class="headerlink" title="服务端代码测试"></a>服务端代码测试</h3><p>所谓服务端代码，指的就是一个node的模块，能在node的环境中运行。以一个项目为例，代码结构如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── index.js</span><br><span class="line">├── node_modules</span><br><span class="line">├── package.json</span><br><span class="line">└── test</span><br><span class="line">    └── test.js</span><br></pre></td></tr></table></figure>
<p>前端测试框架主要是<a href="https://mochajs.org/" target="_blank" rel="noopener">Mocha</a>与<a href="https://jasmine.github.io/" target="_blank" rel="noopener">Jasmine</a>，这里我们选择Mocha，断言库有<a href="https://github.com/shouldjs/should.js" target="_blank" rel="noopener">should</a>、<a href="https://github.com/Automattic/expect.js" target="_blank" rel="noopener">expect</a>、<a href="http://chaijs.com/" target="_blank" rel="noopener">chai</a>以及node自带的assert。这里我们选择chai，chai中包含了expect、should及assert的书写风格。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mocha chai --save-dev</span><br></pre></td></tr></table></figure>
<ul>
<li>index.js</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">const getNum = (value) =&gt; &#123;</span><br><span class="line">  return value * 2</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = getNum</span><br></pre></td></tr></table></figure>
<ul>
<li>test.js</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const chai = require(&apos;chai&apos;)</span><br><span class="line">const expect = chai.expect</span><br><span class="line">const getNum = require(&apos;../index&apos;)</span><br><span class="line"></span><br><span class="line">describe(&apos;Test&apos;, function() &#123;</span><br><span class="line">  it(&apos;should return 20 when the value is 10&apos;, function() &#123;</span><br><span class="line">  	expect(getNum(10)).to.equal(20)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>describe用于给测试用例分组，it代表一个测试用例。</p>
<ul>
<li>package.json</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;test&quot;: &quot;mocha&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p> 需要在全局下安装Mocha</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mocha -g</span><br></pre></td></tr></table></figure>
<p>项目目录下执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run test</span><br></pre></td></tr></table></figure>
<p>测试通过<br><img width="324" alt="2018-01-11 10 43 02" src="https://user-images.githubusercontent.com/11615211/34821686-89f77060-f6ff-11e7-9875-f5e878b27a69.png"></p>
<p>完成代码测试之后我们再去看看代码测试的覆盖率。测试代码覆盖率我们选择使用<a href="https://github.com/gotwarlost/istanbul" target="_blank" rel="noopener">istanbul</a>，全局安装</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g istanbul</span><br></pre></td></tr></table></figure>
<p>使用istanbul启动Mocha</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">istanbul cover _mocha</span><br></pre></td></tr></table></figure>
<p>测试通过，覆盖率100%</p>
<p><img width="565" alt="2018-01-11 11 15 35" src="https://user-images.githubusercontent.com/11615211/34821707-961104c4-f6ff-11e7-9bd9-ffedadcac833.png"></p>
<p>行覆盖率（line coverage）：是否每一行都执行了？<br>函数覆盖率（function coverage）：是否每个函数都调用了？<br>分支覆盖率（branch coverage）：是否每个if代码块都执行了？<br>语句覆盖率（statement coverage）：是否每个语句都执行了？</p>
<p>修改index.js再看代码覆盖率</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">const getNum = (value) =&gt; &#123;</span><br><span class="line">  if(value === 0) &#123;</span><br><span class="line">	return 1</span><br><span class="line">  &#125;else &#123;</span><br><span class="line">	return value * 2</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = getNum</span><br></pre></td></tr></table></figure>
<p>发现代码覆盖率发生了变化</p>
<p><img width="567" alt="2018-01-11 11 13 34" src="https://user-images.githubusercontent.com/11615211/34821960-4099ac84-f700-11e7-99f8-c2a665457cf8.png"></p>
<p>修改test.js添加测试用例</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">describe(&apos;Test&apos;, function() &#123;</span><br><span class="line">  it(&apos;should return 20 when the value is 10&apos;, function() &#123;</span><br><span class="line">  	expect(getNum(10)).to.equal(20)</span><br><span class="line">  &#125;)</span><br><span class="line">  it(&apos;should return 1 when the value is 0&apos;, function() &#123;</span><br><span class="line">    expect(getNum(0)).to.equal(0)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<p>代码覆盖率又回到了100%</p>
<p><img width="567" alt="2018-01-11 11 26 17" src="https://user-images.githubusercontent.com/11615211/34821742-a99a982a-f6ff-11e7-9169-fa265197159e.png"></p>
<h3 id="客户端代码"><a href="#客户端代码" class="headerlink" title="客户端代码"></a>客户端代码</h3><p>客户端代码即运行在浏览器中的代码，代码中包含了window、document等对象，需要在浏览器环境下才能起作用。还是以一个项目为例，代码结构如下:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── index.js</span><br><span class="line">├── node_modules</span><br><span class="line">├── package.json</span><br><span class="line">└── test</span><br><span class="line">    └── test.js</span><br><span class="line">    └── test.html</span><br></pre></td></tr></table></figure>
<p>我们依然使用Mocha测试库及chai断言库。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mocha chai --save-dev</span><br></pre></td></tr></table></figure>
<ul>
<li>index.js</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">window.createDiv = function(value) &#123;</span><br><span class="line">  var oDiv = document.createElement(&apos;div&apos;)</span><br><span class="line">  oDiv.id = &apos;myDiv&apos;</span><br><span class="line">  oDiv.innerHTML = value</span><br><span class="line">  document.body.appendChild(oDiv)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<ul>
<li>test.js</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mocha.ui(&apos;bdd&apos;)</span><br><span class="line"></span><br><span class="line">var expect = chai.expect</span><br><span class="line">describe(&quot;Tests&quot;, function () &#123;</span><br><span class="line">  before(function () &#123;</span><br><span class="line">    createDiv(&apos;test&apos;)</span><br><span class="line">  &#125;)</span><br><span class="line">  it(&quot;content right&quot;, function () &#123;</span><br><span class="line">    var el = document.querySelector(&apos;#myDiv&apos;)</span><br><span class="line">    expect(el).to.not.equal(null)</span><br><span class="line">    expect(el.innerHTML).to.equal(&quot;test&quot;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line">mocha.run()</span><br></pre></td></tr></table></figure>
<ul>
<li>test.html</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">   &lt;head&gt;</span><br><span class="line">     &lt;title&gt; Tests &lt;/title&gt;</span><br><span class="line">     &lt;link rel=&quot;stylesheet&quot; href=&quot;../node_modules/mocha/mocha.css&quot;/&gt;</span><br><span class="line">   &lt;/head&gt;</span><br><span class="line">   &lt;body&gt;</span><br><span class="line">     &lt;div id=&quot;mocha&quot;&gt;&lt;/div&gt;</span><br><span class="line">     &lt;script src=&quot;../node_modules/mocha/mocha.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">     &lt;script src=&quot;../node_modules/chai/chai.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">     &lt;script src=&quot;../index.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">     &lt;script src=&quot;./test.js&quot;&gt;&lt;/script&gt;</span><br><span class="line">   &lt;/body&gt;</span><br><span class="line"> &lt;/html&gt;</span><br></pre></td></tr></table></figure>
<p>直接用浏览器打开test.html文件便能看到测试结果<br><img src="https://user-images.githubusercontent.com/11615211/34821773-bcf4636a-f6ff-11e7-9f92-223e31eaf553.png" alt="2018-01-11 2 15 12"></p>
<p>当然我们可以选择<a href="http://phantomjs.org/" target="_blank" rel="noopener">PhantomJS</a>模拟浏览器去做测试，这里我们使用<a href="https://github.com/nathanboktae/mocha-phantomjs" target="_blank" rel="noopener">mocha-phantomjs</a>对test.html做测试。</p>
<p>全局安装mocha-phantomjs</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install mocha-phantomjs -g</span><br></pre></td></tr></table></figure>
<p>修改package.json</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;test&quot;: &quot;mocha-phantomjs test/test.html&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>项目目录下执行</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run test</span><br></pre></td></tr></table></figure>
<p>mocha-phantomjs在mac下执行会报<code>phantomjs terminated with signal SIGSEGV</code>，暂时没有找到什么解决方案。所以我在ubuntu下执行，结果显示如图</p>
<p><img src="https://user-images.githubusercontent.com/11615211/34821810-db0fd622-f6ff-11e7-8f80-53eda337076b.png" alt="2018-01-11 2 31 45"></p>
<p>上述方式虽然能完成代码的单元测试，但是要完成代码覆盖率的计算也没有什么好的方式，所以我选择引入测试管理工具<a href="https://karma-runner.github.io/2.0/index.html" target="_blank" rel="noopener">karma</a></p>
<h3 id="karma使用指南"><a href="#karma使用指南" class="headerlink" title="karma使用指南"></a>karma使用指南</h3><p>略去一大堆介绍karma的废话，项目下引入karma</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install karma --save-dev</span><br></pre></td></tr></table></figure>
<p>初始化配置karma配置文件</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install karma -g</span><br><span class="line">karma init</span><br></pre></td></tr></table></figure>
<p>使用karma默认配置看看每一项的作用</p>
<ul>
<li>Karma.conf.js</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">module.exports = function(config) &#123;</span><br><span class="line">  config.set(&#123;</span><br><span class="line">    basePath: &apos;&apos;, // 设置根目录</span><br><span class="line">    frameworks: [&apos;jasmine&apos;], // 测试框架</span><br><span class="line">    files: [ // 浏览器中加载的文件</span><br><span class="line">    ],</span><br><span class="line">    exclude: [ // 浏览器中加载的文件中排除的文件</span><br><span class="line">    ],</span><br><span class="line">    preprocessors: &#123; // 预处理</span><br><span class="line">    &#125;,</span><br><span class="line">    reporters: [&apos;progress&apos;], // 添加额外的插件</span><br><span class="line">    port: 9876, // 开启测试服务时监听的端口</span><br><span class="line">    colors: true,</span><br><span class="line">    logLevel: config.LOG_INFO,</span><br><span class="line">    autoWatch: true, // 监听文件变化，发生变化则重新编译</span><br><span class="line">    browsers: [&apos;Chrome&apos;], // 测试的浏览器</span><br><span class="line">    singleRun: false, // 执行测试用例后是否关闭测试服务</span><br><span class="line">    concurrency: Infinity</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>此时的项目结构如下所示</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">.</span><br><span class="line">├── index.js</span><br><span class="line">├── node_modules</span><br><span class="line">├── package.json</span><br><span class="line">├── karma.conf.js</span><br><span class="line">└── test</span><br><span class="line">    └── test.js</span><br></pre></td></tr></table></figure>
<p>首先我们将测试框架jasmine改为我们熟悉的mocha及chai，添加files及plugins</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install karma karma-mocha karma-chai mocha chai karma-chrome-launcher --save-dev</span><br></pre></td></tr></table></figure>
<ul>
<li>karma.conf.js</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">module.exports = function(config) &#123;</span><br><span class="line">  config.set(&#123;</span><br><span class="line">    basePath: &apos;&apos;,</span><br><span class="line">    frameworks: [&apos;mocha&apos;, &apos;chai&apos;],</span><br><span class="line">    files: [</span><br><span class="line">        &apos;index.js&apos;,</span><br><span class="line">        &apos;test/*.js&apos;</span><br><span class="line">    ],</span><br><span class="line">    exclude: [</span><br><span class="line">    ],</span><br><span class="line">    preprocessors: &#123;</span><br><span class="line">    &#125;,</span><br><span class="line">    reporters: [&apos;progress&apos;],</span><br><span class="line">    port: 9876,</span><br><span class="line">    colors: true,</span><br><span class="line">    logLevel: config.LOG_INFO,</span><br><span class="line">    autoWatch: true,</span><br><span class="line">    browsers: [&apos;Chrome&apos;],</span><br><span class="line">    singleRun: false,</span><br><span class="line">    concurrency: Infinity,</span><br><span class="line">    plugins: [</span><br><span class="line">      &apos;karma-chrome-launcher&apos;,</span><br><span class="line">      &apos;karma-mocha&apos;,</span><br><span class="line">      &apos;karma-chai&apos;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>全局安装karma-cli</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install -g karma-cli</span><br></pre></td></tr></table></figure>
<p>修改package.json</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&quot;scripts&quot;: &#123;</span><br><span class="line">  &quot;test&quot;: &quot;karma start karma.conf.js&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行npm run test便可以启用chrome去加载页面。</p>
<p><img width="610" alt="2018-01-11 5 13 27" src="https://user-images.githubusercontent.com/11615211/34821863-f1ea35e0-f6ff-11e7-9645-10b845bf0035.png"></p>
<h3 id="karma测试代码覆盖率"><a href="#karma测试代码覆盖率" class="headerlink" title="karma测试代码覆盖率"></a>karma测试代码覆盖率</h3><p>测试代码覆盖率，我们还是选择使用PhantomJS模拟浏览器，将<code>singleRun</code>设为<code>true</code>，即执行完测试用例就退出测试服务。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install karma-phantomjs-launcher --save-dev</span><br></pre></td></tr></table></figure>
<p>将<code>browsers</code>中的<code>Chrome</code>改为<code>PhantomJS</code>，<code>plugins</code>中的<code>karma-chrome-launcher</code>改为<code>karma-phantomjs-launcher</code></p>
<p>执行npm run test ，测试通过且自动退出如图所示</p>
<p><img width="565" alt="2018-01-11 5 17 32" src="https://user-images.githubusercontent.com/11615211/34821876-fbd9b990-f6ff-11e7-8c1b-184ee96fa4ba.png"></p>
<p>引入karma代码覆盖率模块karma-coverage，改模块依赖于istanbul</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install istanbul karma-coverage --save-dev</span><br></pre></td></tr></table></figure>
<p>修改karma.conf.js</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">module.exports = function(config) &#123;</span><br><span class="line">  config.set(&#123;</span><br><span class="line">    basePath: &apos;&apos;,</span><br><span class="line">    frameworks: [&apos;mocha&apos;, &apos;chai&apos;],</span><br><span class="line">    files: [</span><br><span class="line">        &apos;index.js&apos;,</span><br><span class="line">        &apos;test/*.js&apos;</span><br><span class="line">    ],</span><br><span class="line">    exclude: [</span><br><span class="line">    ],</span><br><span class="line">    preprocessors: &#123;</span><br><span class="line">        &apos;index.js&apos;: [&apos;coverage&apos;]</span><br><span class="line">    &#125;,</span><br><span class="line">    reporters: [&apos;progress&apos;, &apos;coverage&apos;],</span><br><span class="line">    port: 9876,</span><br><span class="line">    colors: true,</span><br><span class="line">    logLevel: config.LOG_INFO,</span><br><span class="line">    autoWatch: true,</span><br><span class="line">    browsers: [&apos;PhantomJS&apos;],</span><br><span class="line">    singleRun: true,</span><br><span class="line">    concurrency: Infinity,</span><br><span class="line">    coverageReporter: &#123;</span><br><span class="line">      type : &apos;text-summary&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">      &apos;karma-phantomjs-launcher&apos;,</span><br><span class="line">      &apos;karma-mocha&apos;,</span><br><span class="line">      &apos;karma-coverage&apos;,</span><br><span class="line">      &apos;karma-chai&apos;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>对index.js文件使用coverage进行预处理，加入karma-coverage插件，覆盖率测试输出coverageReporter配置，详见<a href="https://github.com/karma-runner/karma-coverage/blob/master/docs/configuration.md" target="_blank" rel="noopener">这里</a>这里为了方便截图显示将其设为<code>text-summary</code></p>
<p>执行npm run test，显示结果如下图所示</p>
<p><img width="569" alt="2018-01-11 5 30 10" src="https://user-images.githubusercontent.com/11615211/34821893-07cfdfcc-f700-11e7-9c0d-d8dc2bf0b6bb.png"></p>
<h3 id="ES6代码覆盖率计算"><a href="#ES6代码覆盖率计算" class="headerlink" title="ES6代码覆盖率计算"></a>ES6代码覆盖率计算</h3><p>目前的浏览器并不能兼容所有ES6代码，所以ES6代码都需要经过babel编译后才可在浏览器环境中运行，但编译后的代码webpack会加入许多其他的模块，对编译后的代码做测试覆盖率就没什么意义了。</p>
<ul>
<li>index.js</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">const createDiv = value =&gt; &#123;</span><br><span class="line">  var oDiv = document.createElement(&apos;div&apos;)</span><br><span class="line">  oDiv.id = &apos;myDiv&apos;</span><br><span class="line">  oDiv.innerHTML = value</span><br><span class="line">  document.body.appendChild(oDiv)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">module.exports = createDiv</span><br></pre></td></tr></table></figure>
<p>我们使用ES6中的箭头函数</p>
<ul>
<li>test.js</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">const createDiv = require(&apos;../index&apos;)</span><br><span class="line">describe(&quot;Tests&quot;, function () &#123;</span><br><span class="line">  before(function () &#123;</span><br><span class="line">    createDiv(&apos;test&apos;)</span><br><span class="line">  &#125;)</span><br><span class="line">  it(&quot;content right&quot;, function () &#123;</span><br><span class="line">    var el = document.querySelector(&apos;#myDiv&apos;)</span><br><span class="line">    expect(el).to.not.equal(null)</span><br><span class="line">    expect(el.innerHTML).to.equal(&quot;test&quot;)</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<ul>
<li>kama.conf.js</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br></pre></td><td class="code"><pre><span class="line">module.exports = function(config) &#123;</span><br><span class="line">  config.set(&#123;</span><br><span class="line">    basePath: &apos;&apos;,</span><br><span class="line">    frameworks: [&apos;mocha&apos;, &apos;chai&apos;],</span><br><span class="line">    files: [</span><br><span class="line">        &apos;test/*.js&apos;</span><br><span class="line">    ],</span><br><span class="line">    exclude: [</span><br><span class="line">    ],</span><br><span class="line">    preprocessors: &#123;</span><br><span class="line">        &apos;index.js&apos;: [&apos;coverage&apos;],</span><br><span class="line">        &apos;test/*.js&apos;: [&apos;webpack&apos;]</span><br><span class="line">    &#125;,</span><br><span class="line">    reporters: [&apos;progress&apos;, &apos;coverage&apos;],</span><br><span class="line">    port: 9876,</span><br><span class="line">    colors: true,</span><br><span class="line">    logLevel: config.LOG_INFO,</span><br><span class="line">    autoWatch: true,</span><br><span class="line">    browsers: [&apos;PhantomJS&apos;],</span><br><span class="line">    singleRun: true,</span><br><span class="line">    concurrency: Infinity,</span><br><span class="line">    coverageReporter: &#123;</span><br><span class="line">      type : &apos;text-summary&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    webpack: &#123;</span><br><span class="line">      module: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">          &#123;</span><br><span class="line">            test: /\.js$/,</span><br><span class="line">            exclude: /node_modules/,</span><br><span class="line">            use: &#123;</span><br><span class="line">              loader: &apos;babel-loader&apos;,</span><br><span class="line">              options: &#123;</span><br><span class="line">                &quot;presets&quot;: [&quot;es2015&quot;],</span><br><span class="line">                &quot;plugins&quot;: [[&quot;istanbul&quot;]]</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">      &apos;karma-phantomjs-launcher&apos;,</span><br><span class="line">      &apos;karma-mocha&apos;,</span><br><span class="line">      &apos;karma-coverage&apos;,</span><br><span class="line">      &apos;karma-webpack&apos;,</span><br><span class="line">      &apos;karma-chai&apos;,</span><br><span class="line">    ]</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>test.js文件通过require引入index.js文件，所以files只需引入test.js文件，再对test.js做webpack预处理。</p>
<p>需要相关的babel，webpack，karma依赖如下：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&quot;devDependencies&quot;: &#123;</span><br><span class="line">  &quot;babel-core&quot;: &quot;^6.26.0&quot;,</span><br><span class="line">  &quot;babel-loader&quot;: &quot;^7.1.2&quot;,</span><br><span class="line">  &quot;babel-plugin-istanbul&quot;: &quot;^4.1.5&quot;,</span><br><span class="line">  &quot;babel-preset-es2015&quot;: &quot;^6.24.1&quot;,</span><br><span class="line">  &quot;chai&quot;: &quot;^4.1.2&quot;,</span><br><span class="line">  &quot;istanbul&quot;: &quot;^0.4.5&quot;,</span><br><span class="line">  &quot;karma&quot;: &quot;^2.0.0&quot;,</span><br><span class="line">  &quot;karma-chai&quot;: &quot;^0.1.0&quot;,</span><br><span class="line">  &quot;karma-coverage&quot;: &quot;^1.1.1&quot;,</span><br><span class="line">  &quot;karma-mocha&quot;: &quot;^1.3.0&quot;,</span><br><span class="line">  &quot;karma-phantomjs-launcher&quot;: &quot;^1.0.4&quot;,</span><br><span class="line">  &quot;karma-webpack&quot;: &quot;^2.0.9&quot;,</span><br><span class="line">  &quot;mocha&quot;: &quot;^4.1.0&quot;,</span><br><span class="line">  &quot;webpack&quot;: &quot;^3.10.0&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>执行npm run dev显示如图所示</p>
<p><img width="565" alt="2018-01-11 6 03 57" src="https://user-images.githubusercontent.com/11615211/34821908-1621cfae-f700-11e7-95bc-40ca5be5417b.png"></p>
<h3 id="travisCI及coveralls"><a href="#travisCI及coveralls" class="headerlink" title="travisCI及coveralls"></a>travisCI及coveralls</h3><p>travisCI的配置这里不做详解，我们将通过代码测试覆盖率上传到coveralls获取一个covarage的icon。</p>
<p><img src="https://user-images.githubusercontent.com/11615211/34821915-1b098d68-f700-11e7-9650-2cb7a0e0b920.png" alt="2018-01-11 6 29 18"></p>
<p>如果你是服务端代码使用istanbul计算代码覆盖率的</p>
<ul>
<li>.travis.yml</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">language: node_js</span><br><span class="line">node_js:</span><br><span class="line">- &apos;stable&apos;</span><br><span class="line">- 8</span><br><span class="line">branches:</span><br><span class="line">  only:</span><br><span class="line">  - master</span><br><span class="line">install:</span><br><span class="line">- npm install</span><br><span class="line">script:</span><br><span class="line">- npm test</span><br><span class="line">after_script: &quot;npm install coveralls &amp;&amp; cat ./coverage/lcov.info | coveralls&quot;</span><br></pre></td></tr></table></figure>
<p>如果你是服务端代码使用karma计算代码覆盖率的，则需使用coveralls模块</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install coveralls karma-coveralls --save-dev</span><br></pre></td></tr></table></figure>
<ul>
<li>Karma.conf.js</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">// Karma configuration</span><br><span class="line">module.exports = function(config) &#123;</span><br><span class="line">  config.set(&#123;</span><br><span class="line">    basePath: &apos;&apos;,</span><br><span class="line">    frameworks: [&apos;mocha&apos;, &apos;chai&apos;],</span><br><span class="line">    files: [</span><br><span class="line">      &apos;test/*.js&apos;</span><br><span class="line">    ],</span><br><span class="line">    exclude: [],</span><br><span class="line">    preprocessors: &#123;</span><br><span class="line">      &apos;test/*.js&apos;: [&apos;webpack&apos;],</span><br><span class="line">      &apos;index.js&apos;: [&apos;coverage&apos;]</span><br><span class="line">    &#125;,</span><br><span class="line">    reporters: [&apos;progress&apos;, &apos;coverage&apos;, &apos;coveralls&apos;],</span><br><span class="line">    port: 9876,</span><br><span class="line">    colors: true,</span><br><span class="line">    logLevel: config.LOG_INFO,</span><br><span class="line">    autoWatch: true,</span><br><span class="line">    browsers: [&apos;PhantomJS&apos;],</span><br><span class="line">    singleRun: true,</span><br><span class="line">    concurrency: Infinity,</span><br><span class="line">    webpack: &#123;</span><br><span class="line">      module: &#123;</span><br><span class="line">        rules: [</span><br><span class="line">          &#123;</span><br><span class="line">            test: /\.js$/,</span><br><span class="line">            exclude: /node_modules/,</span><br><span class="line">            use: &#123;</span><br><span class="line">              loader: &apos;babel-loader&apos;,</span><br><span class="line">              options: &#123;</span><br><span class="line">                &quot;presets&quot;: [&quot;es2015&quot;],</span><br><span class="line">                &quot;plugins&quot;: [[&quot;istanbul&quot;], [&quot;transform-runtime&quot;]]</span><br><span class="line">              &#125;</span><br><span class="line">            &#125;</span><br><span class="line">          &#125;</span><br><span class="line">        ]</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    coverageReporter: &#123;</span><br><span class="line">      type : &apos;lcov&apos;,</span><br><span class="line">      dir : &apos;coverage/&apos;</span><br><span class="line">    &#125;,</span><br><span class="line">    plugins: [</span><br><span class="line">      &apos;karma-webpack&apos;,</span><br><span class="line">      &apos;karma-phantomjs-launcher&apos;,</span><br><span class="line">      &apos;karma-coverage&apos;,</span><br><span class="line">      &apos;karma-mocha&apos;,</span><br><span class="line">      &apos;karma-chai&apos;,</span><br><span class="line">      &apos;karma-coveralls&apos;</span><br><span class="line">    ],</span><br><span class="line">  &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>plugins添加karma-coveralls，reporters添加coveralls，coverageReporter输出配置改为lcov。</p>
<p>可以参考我自己实现的一个<a href="https://github.com/PLDaily/show-toast" target="_blank" rel="noopener">show-toast</a>库</p>
<h3 id="参考"><a href="#参考" class="headerlink" title="参考"></a>参考</h3><p><a href="https://github.com/tmallfe/tmallfe.github.io/issues/37" target="_blank" rel="noopener">https://github.com/tmallfe/tmallfe.github.io/issues/37</a><br><a href="https://codeutopia.net/blog/2015/03/01/unit-testing-tdd-and-bdd/" target="_blank" rel="noopener">https://codeutopia.net/blog/2015/03/01/unit-testing-tdd-and-bdd/</a><br><a href="https://github.com/jdavis/tdd-vs-bdd" target="_blank" rel="noopener">https://github.com/jdavis/tdd-vs-bdd</a><br><a href="https://jasmine.github.io/" target="_blank" rel="noopener">https://jasmine.github.io/</a><br><a href="https://github.com/bbraithwaite/karma-seed" target="_blank" rel="noopener">https://github.com/bbraithwaite/karma-seed</a><br><a href="https://mochajs.org/" target="_blank" rel="noopener">https://mochajs.org/</a><br><a href="https://toutiao.io/posts/564973/app_preview" target="_blank" rel="noopener">https://toutiao.io/posts/564973/app_preview</a><br><a href="https://coveralls.io/" target="_blank" rel="noopener">https://coveralls.io/</a><br><a href="https://karma-runner.github.io/0.13/index.html" target="_blank" rel="noopener">https://karma-runner.github.io/0.13/index.html</a><br><a href="https://github.com/karma-runner/karma-coverage/blob/master/docs/configuration.md" target="_blank" rel="noopener">https://github.com/karma-runner/karma-coverage/blob/master/docs/configuration.md</a><br><a href="https://shouldjs.github.io/" target="_blank" rel="noopener">https://shouldjs.github.io/</a><br><a href="https://juejin.im/post/59807358518825563e037e3c" target="_blank" rel="noopener">https://juejin.im/post/59807358518825563e037e3c</a><br><a href="http://www.bradoncode.com/blog/2015/02/27/karma-tutorial/" target="_blank" rel="noopener">http://www.bradoncode.com/blog/2015/02/27/karma-tutorial/</a><br><a href="http://docs.casperjs.org/en/latest/quickstart.html" target="_blank" rel="noopener">http://docs.casperjs.org/en/latest/quickstart.html</a><br><a href="https://github.com/gotwarlost/istanbul" target="_blank" rel="noopener">https://github.com/gotwarlost/istanbul</a><br><a href="https://www.jianshu.com/p/ffd6d319f05b" target="_blank" rel="noopener">https://www.jianshu.com/p/ffd6d319f05b</a><br><a href="http://www.bijishequ.com/detail/436708" target="_blank" rel="noopener">http://www.bijishequ.com/detail/436708</a><br><a href="http://phantomjs.org/" target="_blank" rel="noopener">http://phantomjs.org/</a><br><a href="https://github.com/CurtisHumphrey/es6-library-boilerplate" target="_blank" rel="noopener">https://github.com/CurtisHumphrey/es6-library-boilerplate</a><br><a href="http://www.jackpu.com/shi-yong-babel-jspm-karma-jasmine-istanbul-shi-xian-es6-ce-shi-fu-gai-lu/" target="_blank" rel="noopener">http://www.jackpu.com/shi-yong-babel-jspm-karma-jasmine-istanbul-shi-xian-es6-ce-shi-fu-gai-lu/</a><br><a href="https://github.com/JackPu/JavaScript-Algorithm-Learning" target="_blank" rel="noopener">https://github.com/JackPu/JavaScript-Algorithm-Learning</a><br><a href="https://github.com/caitp/karma-coveralls" target="_blank" rel="noopener">https://github.com/caitp/karma-coveralls</a><br><a href="https://github.com/karma-runner/karma-coverage" target="_blank" rel="noopener">https://github.com/karma-runner/karma-coverage</a></p>

            

        </div>
    </div>
    <div id="post-footer" class="post-footer main-content-wrap">
        
            <div class="post-footer-tags">
                <span class="text-color-light text-small">TAGGED IN</span><br/>
                
    <a class="tag tag--primary tag--small t-link" href="/tags/JavaScript/">JavaScript</a>

            </div>
        
        
            <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/Back-end/better-node/" data-tooltip="8 个技巧让你在 2018 年构建更好的 Node.js 应用程序" aria-label="PREVIOUS: 8 个技巧让你在 2018 年构建更好的 Node.js 应用程序">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/Front-end/js-prop/" data-tooltip="JS中的值传递，引用传递，传递引用(共享传递)" aria-label="NEXT: JS中的值传递，引用传递，传递引用(共享传递)">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


        
        
            
        
    </div>
</article>



                <footer id="footer" class="main-content-wrap">
    <span class="copyrights">
        Copyrights &copy; 2018 PLDaily. All Rights Reserved.
    </span>
</footer>

            </div>
            
                <div id="bottom-bar" class="post-bottom-bar" data-behavior="3">
                    <div class="post-actions-wrap">
    <nav>
        <ul class="post-actions post-action-nav">
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/Back-end/better-node/" data-tooltip="8 个技巧让你在 2018 年构建更好的 Node.js 应用程序" aria-label="PREVIOUS: 8 个技巧让你在 2018 年构建更好的 Node.js 应用程序">
                
                    <i class="fa fa-angle-left" aria-hidden="true"></i>
                    <span class="hide-xs hide-sm text-small icon-ml">PREVIOUS</span>
                </a>
            </li>
            <li class="post-action">
                
                    
                    <a class="post-action-btn btn btn--default tooltip--top" href="/Front-end/js-prop/" data-tooltip="JS中的值传递，引用传递，传递引用(共享传递)" aria-label="NEXT: JS中的值传递，引用传递，传递引用(共享传递)">
                
                    <span class="hide-xs hide-sm text-small icon-mr">NEXT</span>
                    <i class="fa fa-angle-right" aria-hidden="true"></i>
                </a>
            </li>
        </ul>
    </nav>
    <ul class="post-actions post-action-share">
        <li class="post-action hide-lg hide-md hide-sm">
            <a class="post-action-btn btn btn--default btn-open-shareoptions" href="#btn-open-shareoptions" aria-label="Share this post">
                <i class="fa fa-share-alt" aria-hidden="true"></i>
            </a>
        </li>
        
        
            
        
        <li class="post-action">
            
                <a class="post-action-btn btn btn--default" href="#" aria-label="Back to top">
            
                <i class="fa fa-list" aria-hidden="true"></i>
            </a>
        </li>
    </ul>
</div>


                </div>
                <div id="share-options-bar" class="share-options-bar" data-behavior="3">
    <i id="btn-close-shareoptions" class="fa fa-close"></i>
    <ul class="share-options">
        
    </ul>
</div>

            
        </div>
        


    
        
    

<div id="about">
    <div id="about-card">
        <div id="about-btn-close">
            <i class="fa fa-remove"></i>
        </div>
        
            <img id="about-card-picture" src="/assets/images/avatar.jpg" alt="Author&#39;s picture"/>
        
            <h4 id="about-card-name">PLDaily</h4>
        
            <div id="about-card-bio"><p>yesterday you said tomorrow</p>
</div>
        
        
            <div id="about-card-job">
                <i class="fa fa-briefcase"></i>
                <br/>
                <p>developer</p>

            </div>
        
        
            <div id="about-card-location">
                <i class="fa fa-map-marker"></i>
                <br/>
                Hangzhou
            </div>
        
    </div>
</div>

        
        
<div id="cover" style="background-image:url('/assets/images/bg.jpg');"></div>
        <!--SCRIPTS-->
<script src="/assets/js/script-peofhqjkzcghmndknakluequy1y6owxdwpaqyju9ntl9zxnk7rdolb3rjjoj.min.js"></script>
<!--SCRIPTS END-->

    



    </body>
</html>
